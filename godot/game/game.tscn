[gd_scene load_steps=8 format=3 uid="uid://dayu6wxnccwhm"]

[ext_resource type="PackedScene" uid="uid://wwe1ojobhi71" path="res://environment/environment.tscn" id="1_vykj5"]
[ext_resource type="Script" path="res://game/game.gd" id="1_y27ob"]
[ext_resource type="PackedScene" uid="uid://cwbdfcdw51eus" path="res://game/level.tscn" id="2_hvccx"]
[ext_resource type="Theme" uid="uid://b0ci0o4ry5ldo" path="res://gui/debug_theme.tres" id="4_1vvct"]
[ext_resource type="PackedScene" uid="uid://colf3fgh55ffe" path="res://gui/health_bar/health_bar.tscn" id="5_0c5jd"]

[sub_resource type="ViewportTexture" id="ViewportTexture_tjoow"]
viewport_path = NodePath("EnvironmentTexture/EnvironmentViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_f6hiq"]
viewport_path = NodePath("LevelTexture/LevelViewport")

[node name="Game" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
script = ExtResource("1_y27ob")

[node name="ColorRect" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="EnvironmentTexture" type="TextureRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_tjoow")

[node name="EnvironmentViewport" type="SubViewport" parent="EnvironmentTexture"]
unique_name_in_owner = true
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="Environment" parent="EnvironmentTexture/EnvironmentViewport" instance=ExtResource("1_vykj5")]
unique_name_in_owner = true

[node name="LevelTexture" type="TextureRect" parent="."]
texture_filter = 1
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_f6hiq")

[node name="LevelViewport" type="SubViewport" parent="LevelTexture"]
unique_name_in_owner = true
transparent_bg = true
snap_2d_transforms_to_pixel = true
size = Vector2i(640, 360)

[node name="Level" parent="LevelTexture/LevelViewport" instance=ExtResource("2_hvccx")]
unique_name_in_owner = true

[node name="DebugContainer" type="VBoxContainer" parent="."]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("4_1vvct")

[node name="TotalLevelWidthLabel" type="Label" parent="DebugContainer"]
unique_name_in_owner = true
layout_mode = 2

[node name="CameraPosLabel" type="Label" parent="DebugContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "WOAH"

[node name="CalculatedCameraLabel" type="Label" parent="DebugContainer"]
unique_name_in_owner = true
layout_mode = 2

[node name="Control" type="Control" parent="DebugContainer"]
custom_minimum_size = Vector2(0, 10)
layout_mode = 2

[node name="LevelViewLabel" type="Label" parent="DebugContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "YAY"

[node name="CalculatedLevelViewLabel" type="Label" parent="DebugContainer"]
unique_name_in_owner = true
layout_mode = 2

[node name="UIOverlay" type="CanvasLayer" parent="."]
visible = false

[node name="Grid" type="GridContainer" parent="UIOverlay"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = -960.0
offset_bottom = -540.0
grow_horizontal = 2
grow_vertical = 2
columns = 2
metadata/_edit_use_anchors_ = true

[node name="Player1" type="Control" parent="UIOverlay/Grid"]
layout_mode = 2

[node name="HealthBar" parent="UIOverlay/Grid/Player1" instance=ExtResource("5_0c5jd")]
layout_mode = 1
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
offset_right = 0.0
offset_bottom = 0.0
scale = Vector2(4, 4)
size_flags_horizontal = 2
size_flags_vertical = 2

[node name="Player2" type="Control" parent="UIOverlay/Grid"]
layout_mode = 2
size_flags_horizontal = 10

[node name="HealthBar" parent="UIOverlay/Grid/Player2" instance=ExtResource("5_0c5jd")]
layout_mode = 2
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
offset_left = 960.0
offset_right = 1201.0
offset_bottom = 0.0
scale = Vector2(-4, 4)
size_flags_horizontal = 10
size_flags_vertical = 2

[connection signal="gui_input" from="LevelTexture" to="." method="_on_level_texture_gui_input"]
